<!DOCTYPE HTML>

<html>
    <head>
        <script type="application/ld+json">
    {
        "@context" : "http://schema.org",
        "@type" : "BlogPosting",
        "mainEntityOfPage": {
             "@type": "WebPage",
             "@id": "\/"
        },
        "articleSection" : "blog",
        "name" : "Rplicate Series: I can\x27t get no ...",
        "headline" : "Rplicate Series: I can\x27t get no ...",
        "description" : "In this third article on Rplicate Series, We will share to you one way to replicate The Economist plot titled \x26ldquo;I can\x26rsquo;t get no \x26hellip;\x26rdquo;. The plot making will also demonstrate ways to converting smooth line into linear line, using guides for legend, and adding a text annotation to a plot. The raw dataset used for this graph was obtained from a PDF, so we will also use tibble package to copy-paste the data into R.",
        "inLanguage" : "en",
        "author" : "",
        "creator" : "",
        "publisher": "",
        "accountablePerson" : "",
        "copyrightHolder" : "",
        "copyrightYear" : "2020",
        "datePublished": "2020-10-26 00:00:00 \x2b0000 UTC",
        "dateModified" : "2020-10-26 00:00:00 \x2b0000 UTC",
        "url" : "\/blog\/rplicate-i-can-t-get-no\/",
        "wordCount" : "2190",
        "keywords" : [ "Data Visualization","ggplot2","Rplicate","Blog" ]
    }
    </script>
        
            
                <title>Rplicate Series: I can&#39;t get no ...</title>
            
        

        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <meta name="generator" content="Hugo 0.55.4" />
        
  
    
  

  

  <link rel="apple-touch-icon-precomposed" href='/favicon/apple-touch-icon-precomposed.png'>
  <link rel="icon" href='/favicon/favicon.png'>
  
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="msapplication-TileImage" content='/favicon/mstile.png'>
  <meta name="application-name" content="Algoritma Technical Blog">
  <meta name="msapplication-tooltip" content="To learn more about our approach to data science problems, feel free to hop over to our blog.">
  <meta name="msapplication-config" content='/favicon/ieconfig.xml'>



        
            <meta name="author" content="David Tahi Ulubalang">
        
        
            
                <meta name="description" content="To learn more about our approach to data science problems, feel free to hop over to our blog.">
            
        

        <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Rplicate Series: I can&#39;t get no ..."/>
<meta name="twitter:description" content="In this third article on Rplicate Series, We will share to you one way to replicate The Economist plot titled &ldquo;I can&rsquo;t get no &hellip;&rdquo;. The plot making will also demonstrate ways to converting smooth line into linear line, using guides for legend, and adding a text annotation to a plot. The raw dataset used for this graph was obtained from a PDF, so we will also use tibble package to copy-paste the data into R."/>
<meta name="twitter:site" content="@teamalgoritma"/>

        <meta property="og:title" content="Rplicate Series: I can&#39;t get no ..." />
<meta property="og:description" content="In this third article on Rplicate Series, We will share to you one way to replicate The Economist plot titled &ldquo;I can&rsquo;t get no &hellip;&rdquo;. The plot making will also demonstrate ways to converting smooth line into linear line, using guides for legend, and adding a text annotation to a plot. The raw dataset used for this graph was obtained from a PDF, so we will also use tibble package to copy-paste the data into R." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/blog/rplicate-i-can-t-get-no/" />
<meta property="article:published_time" content="2020-10-26T00:00:00&#43;00:00"/>
<meta property="article:modified_time" content="2020-10-26T00:00:00&#43;00:00"/>

        <meta property="og:image" content="//images/logo.png">
        <meta property="og:image:type" content="image/png">
        <meta property="og:image:width" content="512">
        <meta property="og:image:height" content="512">
        
<meta itemprop="name" content="Rplicate Series: I can&#39;t get no ...">
<meta itemprop="description" content="In this third article on Rplicate Series, We will share to you one way to replicate The Economist plot titled &ldquo;I can&rsquo;t get no &hellip;&rdquo;. The plot making will also demonstrate ways to converting smooth line into linear line, using guides for legend, and adding a text annotation to a plot. The raw dataset used for this graph was obtained from a PDF, so we will also use tibble package to copy-paste the data into R.">


<meta itemprop="datePublished" content="2020-10-26T00:00:00&#43;00:00" />
<meta itemprop="dateModified" content="2020-10-26T00:00:00&#43;00:00" />
<meta itemprop="wordCount" content="2190">



<meta itemprop="keywords" content="Data Visualization,ggplot2,Rplicate," />

        

        
            
        

        
        
            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atom-one-light.min.css">
            <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway:400,800,900|Source+Sans+Pro:400,700">
            <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.1.25/jquery.fancybox.min.css">
            <link rel="stylesheet" href="/css/main.css">
            <link rel="stylesheet" href="/css/add-on.css">
            <link rel="stylesheet" href="/css/academicons.min.css">
        

        
            
                
            
                
                    <link rel="stylesheet" href="/css/main.css">
                
            
        


  
    
      <link rel="stylesheet" href="/css/night-owl.css" rel="stylesheet" id="theme-stylesheet">
      <script src="/js/highlight.pack.js"></script>
      <script>hljs.initHighlightingOnLoad();</script>
  


      
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-164959107-2', 'auto');
	
	ga('send', 'pageview');
}
</script>






    </head>
    <body>

      
      <div id="wrapper">

    
    
<header id="header">
    
      <h1><a href="/">blog</a></h1>
    

    <nav class="links">
        <ul>
            
                <li>
                    <a href="/">
                            <i class="fa fa-home">&nbsp;</i>Home
                    </a>
                </li>
            
                <li>
                    <a href="/tags/machine-learning/">
                            <i class="fa fa-cog">&nbsp;</i>Machine Learning
                    </a>
                </li>
            
                <li>
                    <a href="/tags/data-visualization/">
                            <i class="fa fa-area-chart">&nbsp;</i>Data Visualization
                    </a>
                </li>
            
                <li>
                    <a href="/tags/">
                            <i class="fa fa-list">&nbsp;</i>Article List
                    </a>
                </li>
            
        </ul>
    </nav>
    <nav class="main">
        <ul>
            
            <li id="share-nav" class="share-menu" style="display:none;">
                <a class="fa-share-alt" href="#share-menu">Share</a>
            </li>
            
            <li class="search">
                <a class="fa-search" href="#search">Search</a>
                <form id="search" method="get" action="//google.com/search">
                    <input type="text" name="q" placeholder="Search" />
                    <input type="hidden" name="as_sitesearch" value="/">
                </form>
            </li>
            <li class="menu">
                <a class="fa-bars" href="#menu">Menu</a>
            </li>
        </ul>
    </nav>
</header>


<section id="menu">

    
        <section>
            <form class="search" method="get" action="//google.com/search">
                <input type="text" name="q" placeholder="Search" />
                <input type="hidden" name="as_sitesearch" value="/">
            </form>
        </section>

    
        <section>
            <ul class="links">
                
                    <li>
                        <a href="/">
                            <h3>
                                <i class="fa fa-home">&nbsp;</i>Home
                            </h3>
                        </a>
                    </li>
                
                    <li>
                        <a href="/tags/machine-learning/">
                            <h3>
                                <i class="fa fa-cog">&nbsp;</i>Machine Learning
                            </h3>
                        </a>
                    </li>
                
                    <li>
                        <a href="/tags/data-visualization/">
                            <h3>
                                <i class="fa fa-area-chart">&nbsp;</i>Data Visualization
                            </h3>
                        </a>
                    </li>
                
                    <li>
                        <a href="/tags/">
                            <h3>
                                <i class="fa fa-list">&nbsp;</i>Article List
                            </h3>
                        </a>
                    </li>
                
            </ul>
        </section>

    
        <section class="recent-posts">
            <div class="mini-posts">
                <header>
                    <h3>Recent Posts</h3>
                </header>
                

                
                    
                

                
                        <article class="mini-post">
                            <header>
                                <h3><a href="/blog/rplicate-i-can-t-get-no/">Rplicate Series: I can&#39;t get no ...</a></h3>
                                
                                <time class="published" datetime=
                                    '2020-10-26'>
                                    October 26, 2020</time>
                            </header>
                            

                        </article>
                
                        <article class="mini-post">
                            <header>
                                <h3><a href="/blog/topic-modeling-lda/">Topic Modelling with Latent Dirichlet Allocation (LDA)</a></h3>
                                
                                <time class="published" datetime=
                                    '2020-10-26'>
                                    October 26, 2020</time>
                            </header>
                            

                        </article>
                
                        <article class="mini-post">
                            <header>
                                <h3><a href="/blog/one-way-anova-test-in-r/">One-Way ANOVA Test in R</a></h3>
                                
                                <time class="published" datetime=
                                    '2020-10-21'>
                                    October 21, 2020</time>
                            </header>
                            

                        </article>
                
                        <article class="mini-post">
                            <header>
                                <h3><a href="/blog/interpreting-black-box-regression-model-with-lime/">Interpreting Black Box Regression Model with LIME</a></h3>
                                
                                <time class="published" datetime=
                                    '2020-10-20'>
                                    October 20, 2020</time>
                            </header>
                            

                        </article>
                
                        <article class="mini-post">
                            <header>
                                <h3><a href="/blog/rplicate-series-cherry-bomb/">Rplicate Series: Cherry Bomb</a></h3>
                                
                                <time class="published" datetime=
                                    '2020-10-02'>
                                    October 2, 2020</time>
                            </header>
                            

                        </article>
                

                
                    <a href=
                        
                            /blog/
                        
                        class="button">View more posts</a>
                
            </div>
        </section>

    
        
</section>

    <section id="share-menu">
    <section id="social-share-nav">
        <ul class="links">
            <header>
                <h3>Share this post <i class="fa fa-smile-o"></i></h3>
            </header>
            



<li>
  <a href="https://twitter.com/intent/tweet?text=Rplicate%20Series%3a%20I%20can%27t%20get%20no%20... by David%20Tahi%20Ulubalang&amp;url=%2fblog%2frplicate-i-can-t-get-no%2f" target="_blank" class="share-btn twitter">
    <i class="fa fa-twitter"></i>
    <p>Twitter</p>
    </a>
</li>








<li>
  <a href="https://www.facebook.com/sharer.php?u=%2fblog%2frplicate-i-can-t-get-no%2f" target="_blank" class="share-btn facebook">
    <i class="fa fa-facebook"></i>
    <p>Facebook</p>
    </a>
</li>







<li>
  <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=%2fblog%2frplicate-i-can-t-get-no%2f&amp;title=Rplicate%20Series%3a%20I%20can%27t%20get%20no%20..." target="_blank" class="share-btn linkedin">
      <i class="fa fa-linkedin"></i>
      <p>LinkedIn</p>
    </a>
</li>











        </ul>
    </section>
</section>

    
    <div id="main">
        
        
        <article class="post">
  <header>
    <div class="title">
        
            <h2><a href="/blog/rplicate-i-can-t-get-no/">Rplicate Series: I can&#39;t get no ...</a></h2>
        
        
    </div>
    <div class="meta">
        

        <time class="published"
            datetime='2020-10-26'>
            October 26, 2020</time>
        <span class="author"><a href="https://github.com/Davidlimbong">David Tahi Ulubalang</a></span>
        
            <p>11 minute read</p>
        
        
    </div>
</header>


  
    <section id="social-share">
      <ul class="icons">
        



<li>
  <a href="https://twitter.com/intent/tweet?text=Rplicate%20Series%3a%20I%20can%27t%20get%20no%20... by David%20Tahi%20Ulubalang&amp;url=%2fblog%2frplicate-i-can-t-get-no%2f" target="_blank" class="share-btn twitter">
    <i class="fa fa-twitter"></i>
    <p>Twitter</p>
    </a>
</li>








<li>
  <a href="https://www.facebook.com/sharer.php?u=%2fblog%2frplicate-i-can-t-get-no%2f" target="_blank" class="share-btn facebook">
    <i class="fa fa-facebook"></i>
    <p>Facebook</p>
    </a>
</li>







<li>
  <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=%2fblog%2frplicate-i-can-t-get-no%2f&amp;title=Rplicate%20Series%3a%20I%20can%27t%20get%20no%20..." target="_blank" class="share-btn linkedin">
      <i class="fa fa-linkedin"></i>
      <p>LinkedIn</p>
    </a>
</li>











      </ul>
    </section>
  

  

  <div id="content">
    

<p>In this third article on <strong>Rplicate Series</strong>, We will share to you one way to replicate The Economist plot titled <strong>&ldquo;I can&rsquo;t get no &hellip;&rdquo;</strong>. The plot making will also demonstrate ways to converting smooth line into <strong>linear line</strong>, using <strong>guides for legend</strong>, and adding a <strong>text annotation</strong> to a plot. The raw dataset used for this graph was obtained from a PDF, so we will also use <strong>tibble</strong> package to copy-paste the data into R.</p>

<p><center> <img src="/img/rplicate3/icant.png" alt="" />{width=&ldquo;60%&rdquo;} </center></p>

<p>Let&rsquo;s dive in below!</p>

<h1 id="load-packages">Load Packages</h1>

<p>These are the basic packages that we will use. Along the way, there will be some packages that we will load just before its use to better understand and remember its functionality.</p>

<pre><code class="language-r">library(dplyr)
library(ggplot2)
</code></pre>

<h1 id="dataset">Dataset</h1>

<h2 id="data-collection">Data Collection</h2>

<p>The data used in this plot is sourced from a PDF file. Fortunately, we can literally <em>copy-paste</em> the data using <code>tribble()</code> from <em>tibble</em> package. Click <a href="https://tibble.tidyverse.org/reference/tribble.html">here</a> for more detailed documentation of tribble.</p>

<pre><code class="language-r">library(tibble)
data1 &lt;- tribble(
              ~V1, ~V2, ~V3, ~V4, ~V5,
  &quot;United States&quot;, 47L, 58L, 56L, 61L,
         &quot;Canada&quot;, 73L, 79L, 78L, 82L,
         &quot;France&quot;, 47L, 54L, 62L, 73L,
        &quot;Germany&quot;, 72L, 77L, 75L, 85L,
         &quot;Greece&quot;, 18L, 25L, 22L, 42L,
        &quot;Hungary&quot;, 42L, 49L, 54L, 63L,
          &quot;Italy&quot;, 36L, 46L, 45L, 60L,
    &quot;Netherlands&quot;, 74L, 82L, 82L, 89L,
         &quot;Poland&quot;, 40L, 43L, 43L, 59L,
          &quot;Spain&quot;, 33L, 48L, 48L, 63L,
         &quot;Sweden&quot;, 66L, 78L, 78L, 86L,
             &quot;UK&quot;, 52L, 64L, 63L, 74L,
         &quot;Russia&quot;, 55L, 68L, 60L, 79L,
      &quot;Australia&quot;, 48L, 60L, 57L, 65L,
          &quot;India&quot;, 65L, 72L, 80L, 72L,
      &quot;Indonesia&quot;, 77L, 85L, 85L, 89L,
          &quot;Japan&quot;, 55L, 55L, 65L, 74L,
    &quot;Philippines&quot;, 78L, 83L, 86L, 87L,
    &quot;South Korea&quot;, 27L, 26L, 36L, 44L,
        &quot;Vietnam&quot;, 78L, 78L, 80L, 85L,
         &quot;Israel&quot;, 42L, 50L, 63L, 78L,
         &quot;Jordan&quot;, 46L, 47L, 55L, 60L,
        &quot;Lebanon&quot;, 36L, 62L, 48L, 73L,
        &quot;Tunisia&quot;, 48L, 52L, 56L, 58L,
         &quot;Turkey&quot;, 57L, 73L, 65L, 74L,
          &quot;Ghana&quot;, 68L, 70L, 77L, 81L,
          &quot;Kenya&quot;, 70L, 75L, 80L, 82L,
        &quot;Nigeria&quot;, 67L, 68L, 71L, 74L,
        &quot;Senegal&quot;, 75L, 75L, 72L, 84L,
   &quot;South Africa&quot;, 65L, 69L, 73L, 76L,
       &quot;Tanzania&quot;, 83L, 89L, 93L, 92L,
      &quot;Argentina&quot;, 37L, 38L, 45L, 56L,
         &quot;Brazil&quot;, 45L, 54L, 57L, 66L,
          &quot;Chile&quot;, 36L, 36L, 42L, 55L,
       &quot;Colombia&quot;, 38L, 43L, 41L, 57L,
         &quot;Mexico&quot;, 58L, 55L, 62L, 68L,
           &quot;Peru&quot;, 42L, 42L, 51L, 59L,
      &quot;Venezuela&quot;, 52L, 50L, 58L, 62L
  )

data2 &lt;- tribble(
               ~V1,            ~V2, ~V3, ~V4, ~V5, ~V6, ~V7,  ~V8,
   &quot;United States&quot;, &quot;Spring, 2017&quot;, 15L, 36L, 24L, 23L,  2L, 100L,
          &quot;Canada&quot;, &quot;Spring, 2017&quot;, 20L, 47L, 18L, 14L,  1L, 100L,
          &quot;France&quot;, &quot;Spring, 2017&quot;,  3L, 17L, 36L, 42L,  1L, 100L,
         &quot;Germany&quot;, &quot;Spring, 2017&quot;, 26L, 43L, 19L, 10L,  1L, 100L,
          &quot;Greece&quot;, &quot;Spring, 2017&quot;,  1L, 12L, 26L, 60L,  1L, 100L,
         &quot;Hungary&quot;, &quot;Spring, 2017&quot;,  9L, 48L, 25L, 16L,  2L, 100L,
           &quot;Italy&quot;, &quot;Spring, 2017&quot;,  1L, 25L, 47L, 26L,  2L, 100L,
     &quot;Netherlands&quot;, &quot;Spring, 2017&quot;, 24L, 47L, 20L,  9L,  1L, 100L,
          &quot;Poland&quot;, &quot;Spring, 2017&quot;, 14L, 28L, 31L, 24L,  4L, 100L,
           &quot;Spain&quot;, &quot;Spring, 2017&quot;,  5L, 12L, 40L, 41L,  1L, 100L,
          &quot;Sweden&quot;, &quot;Spring, 2017&quot;, 15L, 52L, 23L, 10L,  0L, 100L,
  &quot;United Kingdom&quot;, &quot;Spring, 2017&quot;, 14L, 35L, 28L, 20L,  4L, 100L,
          &quot;Russia&quot;, &quot;Spring, 2017&quot;, 20L, 47L, 24L,  6L,  3L, 100L,
       &quot;Australia&quot;, &quot;Spring, 2017&quot;,  7L, 41L, 29L, 21L,  2L, 100L,
           &quot;India&quot;, &quot;Spring, 2017&quot;, 39L, 46L,  7L,  4L,  4L, 100L,
       &quot;Indonesia&quot;, &quot;Spring, 2017&quot;, 30L, 53L, 15L,  1L,  0L, 100L,
           &quot;Japan&quot;, &quot;Spring, 2017&quot;,  6L, 51L, 33L,  7L,  3L, 100L,
     &quot;Philippines&quot;, &quot;Spring, 2017&quot;, 36L, 44L, 16L,  4L,  0L, 100L,
     &quot;South Korea&quot;, &quot;Spring, 2017&quot;,  2L, 21L, 50L, 25L,  2L, 100L,
         &quot;Vietnam&quot;, &quot;Spring, 2017&quot;, 31L, 51L, 16L,  1L,  1L, 100L,
          &quot;Israel&quot;, &quot;Spring, 2017&quot;, 14L, 37L, 33L, 14L,  2L, 100L,
          &quot;Jordan&quot;, &quot;Spring, 2017&quot;, 13L, 35L, 30L, 18L,  3L, 100L,
         &quot;Lebanon&quot;, &quot;Spring, 2017&quot;,  2L, 13L, 42L, 43L,  1L, 100L,
         &quot;Tunisia&quot;, &quot;Spring, 2017&quot;, 11L, 18L, 14L, 56L,  2L, 100L,
           &quot;Ghana&quot;, &quot;Spring, 2017&quot;, 51L, 19L, 13L, 13L,  4L, 100L,
           &quot;Kenya&quot;, &quot;Spring, 2017&quot;, 28L, 40L, 20L, 12L,  1L, 100L,
         &quot;Nigeria&quot;, &quot;Spring, 2017&quot;, 34L, 20L, 21L, 24L,  1L, 100L,
         &quot;Senegal&quot;, &quot;Spring, 2017&quot;, 37L, 23L, 22L, 16L,  2L, 100L,
    &quot;South Africa&quot;, &quot;Spring, 2017&quot;, 22L, 22L, 28L, 24L,  3L, 100L,
        &quot;Tanzania&quot;, &quot;Spring, 2017&quot;, 48L, 41L,  5L,  4L,  1L, 100L,
       &quot;Argentina&quot;, &quot;Spring, 2017&quot;, 10L, 12L, 41L, 34L,  3L, 100L,
          &quot;Brazil&quot;, &quot;Spring, 2017&quot;,  2L, 22L, 18L, 56L,  3L, 100L,
           &quot;Chile&quot;, &quot;Spring, 2017&quot;,  5L, 10L, 51L, 32L,  2L, 100L,
        &quot;Colombia&quot;, &quot;Spring, 2017&quot;,  7L,  5L, 51L, 36L,  1L, 100L,
          &quot;Mexico&quot;, &quot;Spring, 2017&quot;,  2L, 15L, 39L, 43L,  1L, 100L,
            &quot;Peru&quot;, &quot;Spring, 2017&quot;,  4L,  8L, 55L, 31L,  2L, 100L,
       &quot;Venezuela&quot;, &quot;Spring, 2017&quot;, 14L, 15L, 24L, 45L,  2L, 100L
  )

# adding colnames to data1
colnames(data1) &lt;- c(&quot;Country&quot;,&quot;Political_issues&quot;, &quot;News about govt. leaders and officials&quot;,&quot;News accurately&quot;,&quot;Most important news events&quot;)

# adding colnames to data2
colnames(data2) &lt;- c(&quot;Country&quot;,&quot;x&quot;, &quot;A lot&quot;, &quot;Somewhat&quot;, &quot;Not much&quot;, &quot;Not at all&quot;, &quot;DK/Refused&quot;, &quot;Total&quot;)
</code></pre>

<p>Below is a glimpse of our data:</p>

<pre><code class="language-r">head(data1, 3)
</code></pre>

<pre><code>#&gt; # A tibble: 3 x 5
#&gt;   Country  Political_issues `News about govt.~ `News accuratel~ `Most important~
#&gt;   &lt;chr&gt;               &lt;int&gt;              &lt;int&gt;            &lt;int&gt;            &lt;int&gt;
#&gt; 1 United ~               47                 58               56               61
#&gt; 2 Canada                 73                 79               78               82
#&gt; 3 France                 47                 54               62               73
</code></pre>

<pre><code class="language-r">head(data2, 3)
</code></pre>

<pre><code>#&gt; # A tibble: 3 x 8
#&gt;   Country    x       `A lot` Somewhat `Not much` `Not at all` `DK/Refused` Total
#&gt;   &lt;chr&gt;      &lt;chr&gt;     &lt;int&gt;    &lt;int&gt;      &lt;int&gt;        &lt;int&gt;        &lt;int&gt; &lt;int&gt;
#&gt; 1 United St~ Spring~      15       36         24           23            2   100
#&gt; 2 Canada     Spring~      20       47         18           14            1   100
#&gt; 3 France     Spring~       3       17         36           42            1   100
</code></pre>

<h2 id="feature-selection">Feature Selection</h2>

<p>There are some features that we need to add and also select for visualization. But before that, we should first join our data. Here, we can join our data using the function <code>merge()</code> from base R.</p>

<pre><code class="language-r"># join data
dataset &lt;- merge(data1, data2, by = &quot;Country&quot;)
</code></pre>

<pre><code class="language-r"># feature engineering `gov`
data_f &lt;- dataset %&gt;% 
  mutate(gov = `A lot` + Somewhat) %&gt;% 
  select(Country,Political_issues,gov)

head(data_f, 3)
</code></pre>

<pre><code>#&gt;     Country Political_issues gov
#&gt; 1 Argentina               37  22
#&gt; 2 Australia               48  48
#&gt; 3    Brazil               45  24
</code></pre>

<pre><code class="language-r"># preparing region-country labels
Asia_Oceania &lt;- c(&quot;Australia&quot;, &quot;India&quot;, &quot;Indonesia&quot;, &quot;Japan&quot;,
                  &quot;Philippines&quot;, &quot;South Korea&quot;, &quot;Vietnam&quot;)
Europe &lt;- c(&quot;France&quot;, &quot;Germany&quot;, &quot;Greece&quot;, &quot;Hungary&quot;, &quot;Italy&quot;,
            &quot;Netherlands&quot;, &quot;Poland&quot;, &quot;Spain&quot;, &quot;Sweden&quot;, &quot;UK&quot;, &quot;Russia&quot;)
MidEast_NAfrica &lt;- c(&quot;Israel&quot;, &quot;Jordan&quot;, &quot;Lebanon&quot;, 
                            &quot;Tunisia&quot;, &quot;Turkey&quot;)
SouthAmerica &lt;- c(&quot;Argentina&quot;, &quot;Brazil&quot;, &quot;Chile&quot;, 
                  &quot;Colombia&quot;, &quot;Mexico&quot;, &quot;Peru&quot;, &quot;Venezuela&quot;)
SubSaharaAfrica &lt;- c(&quot;Ghana&quot;, &quot;Kenya&quot;, &quot;Nigeria&quot;, 
                     &quot;Senegal&quot;, &quot;South Africa&quot;, &quot;Tanzania&quot;)
NorthAmerica &lt;- c(&quot;United States&quot;, &quot;Canada&quot;)

# feature engineering `region`
data_f &lt;- data_f %&gt;% 
  mutate(region = ifelse(data_f$Country %in% Asia_Oceania, 'Asia &amp; Oceania',
          ifelse(data_f$Country %in% Europe, 'Europe',
          ifelse(data_f$Country %in% MidEast_NAfrica, 'Middle East &amp; North Africa',
          ifelse(data_f$Country %in% SouthAmerica, 'South America',
          ifelse(data_f$Country %in% SubSaharaAfrica, 'Sub-Sahara Africa',
          ifelse(data_f$Country %in% NorthAmerica, 'North America',
          NA)))))))

# quick check
head(data_f, 3)
</code></pre>

<pre><code>#&gt;     Country Political_issues gov         region
#&gt; 1 Argentina               37  22  South America
#&gt; 2 Australia               48  48 Asia &amp; Oceania
#&gt; 3    Brazil               45  24  South America
</code></pre>

<h1 id="plotting">Plotting</h1>

<p>Before making anything, we can first load fonts from our locale to R using <strong>extrafont</strong> package. This will allow R to use custom fonts in its plot. Discussions about using custom font can be found in the previous <a href="https://algotech.netlify.app/tags/rplicate/">Rplicate Series articles</a>.</p>

<pre><code class="language-r">library(extrafont)

# importing fonts to R
# font_import() 

# load all fonts so it can be used
loadfonts(device = &quot;win&quot;) 
</code></pre>

<h2 id="basic-plot">Basic Plot</h2>

<p>We can first make the Basic Plot using the code below:</p>

<pre><code class="language-r">g1 &lt;- ggplot(data = data_f, 
             aes(x = gov, y = Political_issues)) +
  geom_point(aes(colour = region, fill = region), # we will edit the color &amp; fill manually later
             shape = 21, size = 3.5, stroke = 1) +
  scale_x_continuous(breaks = seq(0,100, by=20), limits = c(0,100)) +
  scale_y_continuous(breaks = seq(0,100, by=20), limits = c(0,100),
                     expand = expansion(add = c(0, 5))) # adjusting spaces on the min-max y-axis)

g1
</code></pre>

<p><img src="/blog/2020-10-26-rplicate-series-i-can-t-get-no_files/figure-html/unnamed-chunk-9-1.png" width="672" style="display: block; margin: auto;" /></p>

<h2 id="add-linear-line">Add Linear Line</h2>

<p>This is the more interesting part of making the plot. When using <code>geom_smooth()</code>, we usually aim to display a trend line following pattern in our data and ended up obtaining a slightly curved line. Little that we know, this function can also be used for <em>making a linear line</em>, we only need to adjust its parameter <code>method</code> on how to make the trend line using a specific algorithm.</p>

<pre><code class="language-r">g2 &lt;- g1 + 
  geom_smooth(aes(group = 1), # making 1 line
              method = &quot;lm&quot;, # making a linear plot (using linear model)
              # formula = y ~ x, # we can also edit the linear model formula manually here
              se = FALSE, # not displaying standard error
              color = &quot;#77200b&quot;) # color of line 

g2
</code></pre>

<p><img src="/blog/2020-10-26-rplicate-series-i-can-t-get-no_files/figure-html/unnamed-chunk-10-1.png" width="672" style="display: block; margin: auto;" /></p>

<p>Now, the trend line was made but it disturb our view on the other geoms. It is best to rearrange the geoms so that the trend line positioned in the first layer of the plot. The combined codes from the previous steps are below and we will use it for further process.</p>

<pre><code class="language-r">g2 &lt;- ggplot(data = data_f, 
             aes(x = gov, y = Political_issues)) +
  geom_smooth(aes(group = 1), 
              method = &quot;lm&quot;, 
              se = FALSE, 
              color = &quot;#77200b&quot;) +
  geom_point(aes(colour = region, fill = region), 
             shape = 21, size = 3.5, stroke = 1) +
  scale_x_continuous(breaks = seq(0,100, by=20), limits = c(0,100)) +
  scale_y_continuous(breaks = seq(0,100, by=20), limits = c(0,100),
                     expand = expansion(add = c(0, 5))) 

g2
</code></pre>

<p><img src="/blog/2020-10-26-rplicate-series-i-can-t-get-no_files/figure-html/unnamed-chunk-11-1.png" width="672" style="display: block; margin: auto;" /></p>

<h2 id="add-repelled-text">Add Repelled Text</h2>

<p>Just like in the previous <a href="https://algotech.netlify.app/blog/rplicate-happiness-of-the-third-age/">&ldquo;Rplicate Series: Happiness of The Third Age&rdquo;</a>, we can add repelled text label using <code>geom_text_repel()</code> from package <em>ggrepel</em>.</p>

<pre><code class="language-r">library(ggrepel)
g3 &lt;- g2 + geom_text_repel(aes(label = Country), force = 2,
                           color = &quot;grey20&quot;, size = 3, family = &quot;Segoe UI&quot;)

g3
</code></pre>

<p><img src="/blog/2020-10-26-rplicate-series-i-can-t-get-no_files/figure-html/unnamed-chunk-12-1.png" width="672" style="display: block; margin: auto;" /></p>

<h2 id="add-labels-title">Add Labels &amp; Title</h2>

<pre><code class="language-r">g4 &lt;- g3 + 
  labs(title = &quot;I can't get no...&quot;,
       subtitle = &quot;Trust in goverment and satifaction with the media, 2017&quot;,
       x = &quot;Trust the national goverment to do what is right for our country, % of respondents&quot;,
       y = &quot;Satisfied with the news media in our country*, % of respondents&quot;,
       caption = &quot;Source: Pew Research Centre&quot;,
       color = NULL,
       fill = NULL) # removing legend title

g4
</code></pre>

<p><img src="/blog/2020-10-26-rplicate-series-i-can-t-get-no_files/figure-html/unnamed-chunk-13-1.png" width="672" style="display: block; margin: auto;" /></p>

<h2 id="custom-point-colour">Custom Point Colour</h2>

<p>To further replicate the original plot, we can also set colors and fill manually for points using <code>scale_color/fill_manual()</code>. Note that to do that, we need to specify a point shape that consist of area and border, such as shape 21. In the function, we can add values of the color/fill and labels for its respective color. We should also note that the order is based on the original level order in the data.</p>

<pre><code class="language-r">g5 &lt;- g4 + scale_color_manual(values = c(&quot;#DE8321&quot;,&quot;#1D84C6&quot;,&quot;#0B743D&quot;,
                                         &quot;#000000&quot;, &quot;#DA3411&quot;,&quot;#04452D&quot;),
                              # we can provide custom label as well, respected to the data
                              labels = c(&quot;Asia &amp;\nOceania&quot;, &quot;Europe&quot;,&quot;Middle East &amp;\nNorth Africa&quot;,
                                         &quot;North\nAmerica&quot;, &quot;South America&quot;, &quot;Sub-Sahara Africa&quot;)
                              ) +
  scale_fill_manual(values = c(&quot;#EB983F&quot;,&quot;#3FCEEB&quot;,&quot;#3FB879&quot;,
                               &quot;#E33010&quot;, &quot;#FFFFFF&quot;,&quot;#0C8E5E&quot;),
                    labels = c(&quot;Asia &amp;\nOceania&quot;, &quot;Europe&quot;,&quot;Middle East &amp;\nNorth Africa&quot;,
                               &quot;North\nAmerica&quot;, &quot;South America&quot;, &quot;Sub-Sahara Africa&quot;)
                    )

g5
</code></pre>

<p><img src="/blog/2020-10-26-rplicate-series-i-can-t-get-no_files/figure-html/unnamed-chunk-14-1.png" width="672" style="display: block; margin: auto;" /></p>

<h2 id="customize-theme">Customize Theme</h2>

<p>Next, we can tidy our plot using themes using the codes below.</p>

<pre><code class="language-r">g6 &lt;- g5 + theme(

  # general
  text = element_text(family = &quot;Segoe UI&quot;),
  
  # legend
  legend.key.size = unit(0.1, &quot;lines&quot;), # set space between keys
  legend.key = element_rect(fill = NA), # removing backround of keys
  legend.text = element_text(size = 10),
  legend.position = &quot;top&quot;,
  legend.direction = &quot;horizontal&quot;,

  # axis
  axis.title = element_text(face = &quot;italic&quot;, size = 10),
  
  # plot (all plot area including title, axis, etc.)
  plot.title = element_text(face = &quot;bold&quot;, size = 15),
  plot.subtitle = element_text(size = 10, 
                               # adding some space between subtitle &amp; legend
                               margin = margin(t =0,  
                                               r = 0, 
                                               b = 10, 
                                               l = 0, 
                                               unit = &quot;pt&quot;)),
  plot.caption = element_text(size = 8, hjust = 0, vjust = 0.5),
  
  # panel (area where we map our geoms)
  panel.border = element_blank(),
  panel.background = element_blank(),
  panel.grid.major.x = element_blank(),
  panel.grid.major.y = element_line(size = 0.1, color = &quot;grey66&quot;),
  panel.grid.minor = element_blank()
  
  )

g6
</code></pre>

<p><img src="/blog/2020-10-26-rplicate-series-i-can-t-get-no_files/figure-html/unnamed-chunk-15-1.png" width="672" style="display: block; margin: auto;" /></p>

<h2 id="guides-annotation">Guides &amp; Annotation</h2>

<p>To have more flexibility in editing plot features such as legend, we can use <code>guides()</code> from ggplot2. There are various graphical features which you can apply guides into such as <code>guide_axis()</code>, <code>guide_colorbar()</code>, <code>guide_geoms()</code>, etc. We encourage you to visit the official ggplot2 documentation and explore it according to your needs on the net. Here, we will only use <code>guide_legend()</code> to custom our legend so that it will only display 1 row.</p>

<pre><code class="language-r">g7 &lt;- g6 + guides(color = guide_legend(nrow = 1))

g7
</code></pre>

<p><img src="/blog/2020-10-26-rplicate-series-i-can-t-get-no_files/figure-html/unnamed-chunk-16-1.png" width="672" style="display: block; margin: auto;" /></p>

<p>Last but not least, we can add text annotation into our plot using the function <code>annotate()</code> from ggplot2. There are various geoms you can annotate inside a plot, such as a rectangle, an arrow, a segment, etc. For a friendly introduction, you can refer to <a href="https://ggplot2.tidyverse.org/reference/annotate.html">R Graph Gallery - Annotations</a> or to the official <a href="https://ggplot2.tidyverse.org/reference/annotate.html">ggplot2 documentation</a>.</p>

<p>Here, we will add annotations for the geometrical element <code>segment</code> and <code>text</code> for our trend line legend.</p>

<pre><code class="language-r">g8 &lt;- g7 + annotate(geom = &quot;segment&quot;, # making a line segment
              x = 67, xend = 69, y = 13, yend = 13, # position of segment 
              colour = &quot;#77200b&quot;, 
              size = 1
              ) +
     annotate(geom = &quot;text&quot;, # making a text
              x = 70, y = 10, # position of text
              label = &quot;Line of best fit,\ncorrelation coefficient = 87%&quot;,
              fontface = &quot;italic&quot;, color = &quot;#77200b&quot;, size = 4, family = &quot;Segoe UI&quot;, 
              hjust = 0) # set the text on the right side of segment
</code></pre>

<h1 id="final-plot">Final Plot</h1>

<p>Now let&rsquo;s display our final plot! We can display our plot with the desired height and width by specifying it in the R chunk setting. Below is the plot created with an R Markdown chunk setting <code>fig.height = 6, fig.width = 7</code>.</p>

<pre><code class="language-r">g8
</code></pre>

<p><img src="/blog/2020-10-26-rplicate-series-i-can-t-get-no_files/figure-html/unnamed-chunk-18-1.png" width="672" style="display: block; margin: auto;" /></p>

<p>Thank you for reading and we hope this article can help you to create a more interesting visualization. We hope you can find the delight in exploring data visualization in R. Happy learning and coding!</p>

  </div>

  <footer>
    <ul class="stats">
  <li class="categories">
    <ul>
        
            
            
                <i class="fa fa-folder"></i>
                
                
                <li><a class="article-category-link" href="/categories/r">R</a></li>
                
            
        
    </ul>
  </li>
  <li class="tags">
    <ul>
        
            
            
                <i class="fa fa-tags"></i>
                
                
                <li><a class="article-category-link" href="/tags/data-visualization">Data Visualization</a></li>
                
                
                <li><a class="article-category-link" href="/tags/ggplot2">ggplot2</a></li>
                
                
                <li><a class="article-category-link" href="/tags/rplicate">Rplicate</a></li>
                
            
        
    </ul>
  </li>
</ul>

  </footer>

</article>

    <article class="post">
        <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "https-algotech-netlify-com" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </article>


<ul class="actions pagination">
    
        <li><a href="/blog/topic-modeling-lda/"
                class="button big previous">Topic Modelling with Latent Dirichlet Allocation (LDA)</a></li>
    

    
</ul>


    </div>
    
<section id="sidebar">

  
  <section id="intro">
    
    
      
        <a href='/'><img src="/img/main/logo.png" class="intro-circle" width="30%" alt="Hugo Future Imperfect" /></a>
      
    
    
      <header>
        <h2>Algoritma Technical Blog</h2>
        <p>We're a group of people who teach data science to individuals, trains companies and their employees to better profit from data. We care about the development of data science and a sense of community that connects our alumni and team with one another. To learn more about our approach to data science problems, feel free to hop over to our blog.</p>
      </header>
    
    
      <ul class="icons">
        
        
  <li><a href="//github.com/teamalgoritma" target="_blank" title="GitHub" class="fa fa-github"></a></li>



























  <li><a href="//linkedin.com/company/teamalgoritma" target="_blank" title="LinkedIn Company" class="fa fa-linkedin"></a></li>









  <li><a href="//facebook.com/teamalgoritma" target="_blank" title="Facebook" class="fa fa-facebook"></a></li>





















  <li><a href="//instagram.com/teamalgoritma" target="_blank" title="Instagram" class="fa fa-instagram"></a></li>





  <li><a href="//twitter.com/teamalgoritma" target="_blank" title="Twitter" class="fa fa-twitter"></a></li>




















      </ul>
    
  </section>

  
  <section class="recent-posts">
    <div class="mini-posts">
      <header>
        <h3>Upcoming Workshop</h3>
      </header>
      <div class="posts-container">
          <article class="mini-post">
            <header>
              <h3>
                
                <img src="/img/2020/ads/ddt.png", alt="alternatetext", width="270" height="340">
                <a href="https://algorit.ma/data-driven-2/?utm_source=algotech">More details</a>
              </h3>
            </header>
          </article>
      </div>

      
      
    </div>
  </section>

  
  
  

  
  

  
  <section id="footer">
    <p class="copyright">
      
        &copy; 2020
        
          Algoritma Technical Blog
        
      .
      Powered by <a href="//gohugo.io" target="_blank">Hugo</a>
    </p>
  </section>
</section>

    </div>
    <a id="back-to-top" href="#" class="fa fa-arrow-up fa-border fa-2x"></a>
    <style>
      .footer {
        position: fixed;
        left: 0;
        bottom: 0;
        width: 100%;
        height:50px; 
        background-color: black;
        color: white;
        text-align: center;
        padding-top: 15px;
        padding-bottom: 15px;
        padding-left: 50px;
        padding-right: 50px;
}
      }


      </style>

      <div class="footer">
        <p>
          Want to know more about our workshop?
          <a href="https://algorit.ma/?utm_source=algotech&utm_medium=content&utm_campaign=rplicate-i-can-t-get-no" style="color: rgb(197, 38, 38)"> Visit our main website here</a> <br>
        </p>
          
      </div>
    

    
      
    

    
      
      
      
        <script src="//cdn.bootcss.com/highlight.js/9.11.0/highlight.min.js"></script>
        
        
        
        <script src="//cdn.bootcss.com/highlight.js/9.11.0/languages/r.min.js"></script>
        <script src="//cdn.bootcss.com/highlight.js/9.11.0/languages/yaml.min.js"></script>
        <script src="//cdn.bootcss.com/highlight.js/9.11.0/languages/css.min.js"></script>
        <script>hljs.configure({languages: []}); hljs.initHighlightingOnLoad();</script>
      
    
    
    
      <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/skel/3.0.1/skel.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.1.25/jquery.fancybox.min.js"></script>
      <script src="/js/util.js"></script>
      <script src="/js/main.js"></script>
      <script src="/js/backToTop.js"></script>
    

    
      
        
      
        
          <script src="/js/bootstrap.min.js"></script>
        
      
    

    
    <script>hljs.initHighlightingOnLoad();</script>
      <script src="//yihui.name/js/math-code.js"></script>
<script async
src="//cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
</script>


  </body>
</html>

